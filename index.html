<!DOCTYPE html>
<html lang="en-us">
	<head>
		<LINK href="stylesheets/stylesheet.css" rel="stylesheet" type="text/css">
	</head>
	<body>
	<script>
	
	Number.prototype.cutZero = function(){
		var numberString = this.toPrecision(14)
		while (numberString.indexOf(".")>0){
			var lastChar = numberString.slice(-1)
			if (lastChar=="0"||lastChar=="."){
				numberString=numberString.slice(0,-1)
			} else {
				break
			}
		}
		if (numberString.indexOf(".")<0){
			return parseInt(numberString)
		} else {
			return parseFloat(numberString)
		}
	}
	
	function calculate_this() {
		
		var sigFig = parseInt(document.getElementById("signif").value)
		
		Number.prototype.truncated = function(){
			return parseFloat(this.toPrecision(sigFig))
		}
		
		var stream1MassFlow = eval(document.getElementById("stream1MassFlow").value)
		
		var stream1InletTemp = eval(document.getElementById("stream1InletTemp").value)
		var stream1OutletTemp = eval(document.getElementById("stream1OutletTemp").value)
		var stream1MeanTemp=(stream1InletTemp+stream1OutletTemp)/2
		var stream1TempDiff = stream1OutletTemp - stream1InletTemp
		stream1MeanTemp = stream1MeanTemp.cutZero()
		document.getElementById('results').innerHTML = "<u>Stream 1</u><br>Mean Temperature: " + stream1MeanTemp.truncated() + " °C<br>"
		
		var stream1MeanSHC=eval(document.getElementById("stream1MeanSHC").value)
		stream1MeanSHC = stream1MeanSHC.cutZero()
		document.getElementById('results').innerHTML += "Mean Spec Heat Capacity: " + stream1StreamMeanSHC.truncated() + " J/kgK<br>"
		
		var stream1MeanTC=eval(document.getElementById("stream1MeanThermCond").value)
		stream1MeanTC = stream1MeanTC.cutZero()
		document.getElementById('results').innerHTML += "Mean Thermal Conductivity: " + stream1MeanTC.truncated() + " W/m °C<br>"
		
		var stream1MeanDensity = eval(document.getElementById("stream1MeanDensity").value)
		stream1MeanDensity = stream1MeanDensity.cutZero()
		document.getElementById('results').innerHTML += "Mean Density: " + stream1MeanDensity.truncated() + " kg/m<sup>3</sup><br>"
		
		var stream1MeanViscosity = eval(document.getElementById("stream1MeanViscosity").value*1e-3)
		stream1MeanViscosity = stream1MeanViscosity.cutZero()
		document.getElementById('results').innerHTML += "Mean Viscosity: " + (stream1MeanViscosity*1e3).truncated() + " mNs/m<sup>2</sup> [cP]<br>"
		
		var duty = stream1MassFlow*stream1MeanSHC*stream1TempDiff
		duty = duty.cutZero()
		document.getElementById('results').innerHTML += "<br>Duty: " + (Math.abs(duty)).truncated() + " W<br><br>"
		
		//var stream2MassFlow = eval(document.getElementById("stream2MassFlow").value)
		var stream2InletTemp = eval(document.getElementById("stream2InletTemp").value)
		var stream2OutletTemp = eval(document.getElementById("stream2OutletTemp").value)
		
		//var stream2OutletTemp = stream2InletTemp-duty/(stream2MassFlow*tubeStreamMeanSHC)
		var stream2MeanTemp=(stream2InletTemp+stream2OutletTemp)/2
		var stream2TempDiff = stream2OutletTemp - stream2InletTemp
		stream2MeanTemp=stream2MeanTemp.cutZero()
		stream2TempDiff = stream2TempDiff.cutZero()
		
		var stream2MeanSHC = eval(document.getElementById("stream2MeanSHC").value)
		stream2MeanSHC=stream2MeanSHC.cutZero()
		var stream2MassFlow = -duty/(stream2TempDiff*tubeStreamMeanSHC) ////////////////////
		document.getElementById('results').innerHTML += "<u>Stream 2</u> [Tubeside]<br>Mass Flow: " + stream2MassFlow.truncated() + " kg/s<br>"
		//document.getElementById('results').innerHTML += "Outlet Temperature: " + stream2OutletTemp.truncated() + " °C<br>"
		document.getElementById('results').innerHTML += "Mean Temperature: " + stream2MeanTemp.truncated() + " °C<br>"
		document.getElementById('results').innerHTML += "Mean Spec Heat Capacity: " + stream2MeanSHC.truncated() + " J/kgK<br>"
		
		var stream2MeanTC = eval(document.getElementById("stream2MeanThermCond").value)
		stream2MeanTC.cutZero()
		document.getElementById('results').innerHTML += "Mean Thermal Conductivity: " + stream2MeanTC.truncated() + " W/m °C<br>"
		
		var stream2MeanDensity = eval(document.getElementById("stream2MeanDensity").value)
		stream2MeanDensity = stream2MeanDensity.cutZero()
		document.getElementById('results').innerHTML += "Mean Density: " + stream2MeanDensity.truncated() + " kg/m<sup>3</sup><br>"
		
		var stream2MeanViscosity = eval(document.getElementById("stream2MeanViscosity").value*1e-3)
		stream2MeanViscosity = stream2MeanViscosity.cutZero()
		document.getElementById('results').innerHTML += "Mean Viscosity: " + (stream2MeanViscosity*1e3).truncated() + " mNs/m<sup>2</sup> [cP]<br>"
		
		var flowConfig = document.getElementById("flowCon").value
		
		if (flowConfig="S1T2"){
			var shellStreamMassFlow = stream1MassFlow
			var shellStreamMeanTemp = stream1MeanTemp
			var shellStreamMeanSHC = stream1MeanSHC
			var shellStreamMeanTC = stream1MeanTC
			var shellStreamMeanDensity = stream1MeanDensity
			var shellStreamMeanViscosity = stream1MeanViscosity
			
			var tubeStreamMassFlow = stream2MassFlow
			var tubeStreamMeanTemp = stream2MeanTemp
			var tubeStreamMeanSHC = stream2MeanSHC
			var tubeStreamMeanTC = stream2MeanTC
			var tubeStreamMeanDensity = stream2MeanDensity
			var tubeStreamMeanViscosity = stream2MeanViscosity
			
			var shellFoulFactor = eval(document.getElementById("stream1FoulFact").value)
			var tubeFoulFactor = eval(document.getElementById("stream2FoulFact").value)
			
			var shellAllowPress = eval(document.getElementById("stream1AllowPress").value)
			var tubeAllowPress = eval(document.getElementById("stream2AllowPress").value)
		}
		if (flowConfig="S2T1"){
			var shellStreamMassFlow = stream2MassFlow
			var shellStreamMeanTemp = stream2MeanTemp
			var shellStreamMeanSHC = stream2MeanSHC
			var shellStreamMeanTC = stream2MeanTC
			var shellStreamMeanDensity = stream2MeanDensity
			var shellStreamMeanViscosity = stream2MeanViscosity
			
			var tubeStreamMassFlow = stream1MassFlow
			var tubeStreamMeanTemp = stream1MeanTemp
			var tubeStreamMeanSHC = stream1MeanSHC
			var tubeStreamMeanTC = stream1MeanTC
			var tubeStreamMeanDensity = stream1MeanDensity
			var tubeStreamMeanViscosity = stream1MeanViscosity
			
			var tubeFoulFactor = eval(document.getElementById("stream1FoulFact").value)
			var shellFoulFactor = eval(document.getElementById("stream2FoulFact").value)
			
			var shellAllowPress = eval(document.getElementById("stream2AllowPress").value)
			var tubeAllowPress = eval(document.getElementById("stream1AllowPress").value)
		}
		
		var currentMode = document.getElementById("currentMode").value
		var currentModeString
		if (currentMode=="counterCurrent"){
			var currentModeString = "Counter-current "
			var LMTDnumerator = (stream1InletTemp - stream2OutletTemp) - (stream1OutletTemp - stream2InletTemp)
			var LMTDdenominator = Math.log((stream1InletTemp - stream2OutletTemp) / (stream1OutletTemp - stream2InletTemp))
			
			var Rnumerator = stream1InletTemp-stream1OutletTemp
			var Rdenominator = stream2OutletTemp-stream2InletTemp
			
			var Snumerator = stream2OutletTemp-stream2InletTemp
			var Sdenominator = stream1InletTemp-stream2InletTemp
		}
		if (currentMode=="coCurrent"){
			var currentModeString = "Co-current "
			var LMTDnumerator = (stream1InletTemp - stream2InletTemp) - (stream1OutletTemp - stream2OutletTemp)
			var LMTDdenominator = Math.log((stream1InletTemp - stream2InletTemp) / (stream1OutletTemp - stream2OutletTemp))
		}
		var R = Rnumerator/Rdenominator
		var S = Snumerator/Sdenominator
		var LMTD = LMTDnumerator/LMTDdenominator
		LMTD = LMTD.cutZero()
		document.getElementById('results').innerHTML += "<br>" + currentModeString + "Log Mean Temperature Difference, ΔT<sub>LM</sub>: " + LMTD.truncated() + " °C<br>"
		document.getElementById('results').innerHTML += "R: " + R.toPrecision(3) + "<br>"
		document.getElementById('results').innerHTML += "S (aka P on chart): " + S.toPrecision(3) + "<br><br>"
		
		document.getElementById('results').innerHTML += "[Check and insert Ft from Figure 12.19 or 12.20]<br><br>"
		
		var U = eval(document.getElementById("estOverCoeff").value)
		var Ft = eval(document.getElementById("Ft").value)
		var dTm = Ft*LMTD
		var heatTransferArea = Math.abs(duty/(U*Ft*LMTD))
		dTm = dTm.cutZero()
		heatTransferArea = heatTransferArea.cutZero()
		document.getElementById('results').innerHTML += "Actual Temperature Difference, ΔT<sub>m</sub>: " + dTm.truncated() + " °C<br>"
		document.getElementById('results').innerHTML += "Heat Transfer Area: " + heatTransferArea.truncated() + " m<sup>2</sup><br>"
		
		var nShellPass = parseInt(document.getElementById("nShellPass").value)
		var nTubePass = parseInt(document.getElementById("nTubePass").value)
		var foo = Math.sqrt(Math.pow(R,2) + 1)
		var Ftnumerator = foo*Math.log((1-S)/(1-R*S))
		var Ftdenominator = (R-1)*Math.log((2-S*(R+ 1 - foo))/(2-S*(R+ 1 + foo)))
		var FtCalculated = Ftnumerator/Ftdenominator
		FtCalculated = FtCalculated.cutZero()
		document.getElementById('results').innerHTML += "<br>For a heat exchanger with " + nShellPass + " shell passes and "
		document.getElementById('results').innerHTML += nTubePass + " tube passes:<br>"
		if (nShellPass==1&&nTubePass==2){
			document.getElementById('results').innerHTML += "Calculated F<sub>t</sub>: " + FtCalculated.truncated() + "<br>"
		}
		
		var outerDiameter = eval(document.getElementById("outerDiameter").value)*1e-3
		var tubePitch = outerDiameter*125/100
		tubePitch = tubePitch.cutZero()
		var tubeLength = eval(document.getElementById("tubeLength").value)
		var areaPerTube = outerDiameter * tubeLength * Math.PI
		areaPerTube = areaPerTube.cutZero()
		var nTube = Math.ceil(eval(document.getElementById("numberTubes").value))
		if (nTube<0){
			nTube = Math.ceil(heatTransferArea/areaPerTube)
		}
		for (i=0;i<nTubePass;i++){
			var nTubePerPass = nTube/nTubePass
			if (nTubePerPass%1==0){
				break;
			} else {
				nTube++
			}
		}
		document.getElementById('results').innerHTML += "<br><b>Tubeside Calculations</b><br>"
		document.getElementById('results').innerHTML += "If pitch/diameter = 1.25, then tube pitch, p<sub>t</sub> = " + (tubePitch*1e3).truncated() + " mm<br>"
		document.getElementById('results').innerHTML += "Area of one tube, neglecting thickness of tube sheet: " + areaPerTube.truncated() + " m<sup>2</sup><br>"
		document.getElementById('results').innerHTML += "Number of tubes required, N<sub>t</sub>: " + nTube + "<br>"
		document.getElementById('results').innerHTML += "For " + nTubePass + " passes, number of tubes per pass: " + nTubePerPass + "<br>"
		
		var innerDiameter = eval(document.getElementById("innerDiameter").value)*1e-3
		var tubeCrossArea = Math.pow(innerDiameter,2)*Math.PI/4
		var areaPerPass = tubeCrossArea*nTubePerPass
		var tubeVolumetricFlow = tubeStreamMassFlow/tubeStreamMeanDensity
		var tubeVelocity = tubeVolumetricFlow/areaPerPass
		tubeCrossArea = tubeCrossArea.cutZero()
		areaPerPass = areaPerPass.cutZero()
		tubeVolumetricFlow = tubeVolumetricFlow.cutZero()
		tubeVelocity = tubeVelocity.cutZero()
		document.getElementById('results').innerHTML += "<br>Tube Cross-sectional Area: " + tubeCrossArea.truncated() + " m<sup>2</sup><br>"
		document.getElementById('results').innerHTML += "Area per pass: " + areaPerPass.truncated() + " m<sup>2</sup><br>"
		document.getElementById('results').innerHTML += "Volumetric Flow of tubeside fluid: " + tubeVolumetricFlow.truncated() + " m<sup>3</sup>/s<br>"
		document.getElementById('results').innerHTML += "Tubeside velocity: " + tubeVelocity.truncated() + " m/s (hopefully between 1 and 2 m/s)<br>"
		
		var listedPassesInTable12point3 = [1,2,4,6,8]
		var currentPitch = document.getElementById("currentPitch").value
		var hyDiamNum
		var hyDiamDenom
		if (currentPitch=="triangular"){
			var Klist=[.319,.249,.175,.0743,.0365];
			var nlist=[2.142,2.207,2.285,2.499,2.675];
			//hyDiamNum = 4*(tubePitch/2*.87*tubePitch-outerDiameter*outerDiameter/2/4*Math.PI)
			//hyDiamDenom = outerDiameter/2*Math.PI
			hyDiamNum = 1.1*(tubePitch*tubePitch-.917*outerDiameter*outerDiameter)
			hyDiamDenom = outerDiameter
		} else if (currentPitch=="square"){
			var Klist=[.215,.156,.158,.0402,.0331];
			var nlist=[2.207,2.291,2.263,2.617,2.643];
			//hyDiamNum = tubePitch*tubePitch-outerDiameter*outerDiameter*Math.PI
			//hyDiamDenom = outerDiameter*Math.PI
			hyDiamNum = 1.27*(tubePitch*tubePitch-.785*outerDiameter*outerDiameter)
			hyDiamDenom = outerDiameter
		}
		var hydraulicDiameter = hyDiamNum/hyDiamDenom
		hydraulicDiameter = hydraulicDiameter.cutZero()
		var index = listedPassesInTable12point3.indexOf(nTubePass)
		var requiredK1 = Klist[index]
		var requiredn1 = nlist[index]
		document.getElementById('results').innerHTML += "<br>For " + nTubePass + "-pass " + currentPitch + " pitch:<br>"
		document.getElementById('results').innerHTML += "K<sub>1</sub> = " + requiredK1 + "<br>"
		document.getElementById('results').innerHTML += "n<sub>1</sub> = " + requiredn1 + "<br>"
		
		var shellClearance = eval(document.getElementById("shellClear").value)*1e-3
		var bundleDiameter = outerDiameter*Math.pow((nTube/requiredK1),(1/requiredn1))
		var shellsideDiameter = bundleDiameter + shellClearance
		bundleDiameter = bundleDiameter.cutZero()
		shellsideDiameter = shellsideDiameter.cutZero()
		document.getElementById('results').innerHTML += "Bundle diameter, D<sub>b</sub>: " + bundleDiameter.truncated() + " m<br>"
		document.getElementById('results').innerHTML += "Shell side diameter, D<sub>s</sub>: " + shellsideDiameter.truncated() + " m<br>"
		
		document.getElementById('results').innerHTML += "<br>[Insert clearance from Figure 12.12]<br>"
		
		var tubeHeatTransferFactor = eval(document.getElementById("tubeHeatTransFac").value)
		var tubeReynoldsNumber = tubeStreamMeanDensity*tubeVelocity*innerDiameter/tubeStreamMeanViscosity
		var tubePrandtlNumber = tubeStreamMeanSHC*tubeStreamMeanViscosity/tubeStreamMeanTC
		var lengthOverInnerDiameter = tubeLength/innerDiameter
		// Need to figure out Nusselt number in the three flow types.
		var tubeNusseltNumber = tubeHeatTransferFactor * tubeReynoldsNumber * Math.pow(tubePrandtlNumber,.33)
		var tubeInsideCoefficient = tubeNusseltNumber/innerDiameter*tubeStreamMeanTC
		var tubeFlowType
		if (tubeReynoldsNumber>1e4){
			tubeFlowType = "turbulent"
		} else if (tubeReynoldsNumber<2e3){
			tubeFlowType = "laminar"
		} else {
			tubeFlowType = "transition"
		}
		tubeReynoldsNumber = tubeReynoldsNumber.cutZero()
		tubePrandtlNumber = tubePrandtlNumber.cutZero()
		lengthOverInnerDiameter = lengthOverInnerDiameter.cutZero()
		tubeNusseltNumber = tubeNusseltNumber.cutZero()
		tubeInsideCoefficient = tubeInsideCoefficient.cutZero()
		document.getElementById('results').innerHTML += "<br>Reynolds number, Re: " + tubeReynoldsNumber.truncated() + " (hence, " + tubeFlowType + " region)<br>"
		document.getElementById('results').innerHTML += "Prandtl number, Pr: " + tubePrandtlNumber.truncated() + "<br>"
		document.getElementById('results').innerHTML += "Ratio of tube length to tube inner diameter: " + lengthOverInnerDiameter.truncated() + "<br>"
		
		document.getElementById('results').innerHTML += "<br>[Check and insert j<sub>H</sub> for tubeside from Figure 12.23]<br><br>"
		
		document.getElementById('results').innerHTML += "Nusselt number, Nu: " + tubeNusseltNumber.truncated() + "<br>"
		document.getElementById('results').innerHTML += "Inside coefficient, h<sub>i</sub>: " + tubeInsideCoefficient.truncated() + " W/m<sup>2</sup> °C<br>"
		
		document.getElementById('results').innerHTML += "<br>[Make adjustments for number of tube passes if needed]<br>"
		
		//var baffleSpacingRatio = baffleSpacingRatio*shellsideDiameter
		var baffleSpacing = eval(document.getElementById("baffleSpace").value)*1e-3
		baffleSpacing = baffleSpacing.cutZero()
		var areaCrossFlow = (tubePitch - outerDiameter)*shellsideDiameter*baffleSpacing/tubePitch
		areaCrossFlow = areaCrossFlow.cutZero()
		var shellVolumetricFlow = shellStreamMassFlow/shellStreamMeanDensity
		shellVolumetricFlow = shellVolumetricFlow.cutZero()
		var shellVelocity = shellVolumetricFlow/areaCrossFlow
		shellVelocity = shellVelocity.cutZero()
		document.getElementById('results').innerHTML += "<br><b>Shellside Calculations</b><br>Baffle spacing, l<sub>B</sub>: " + baffleSpacing.truncated() + " m<br>"
		document.getElementById('results').innerHTML += "Area for cross-flow, A<sub>s</sub>: " + areaCrossFlow.truncated() + " m<sup>2</sup><br>"
		document.getElementById('results').innerHTML += "Hydraulic Diameter, d<sub>e</sub>: " + hydraulicDiameter.truncated() + " m<br>"
		document.getElementById('results').innerHTML += "Volumetric Flow of shellside fluid: " + shellVolumetricFlow.truncated() + " m<sup>3</sup>/s<br>"
		document.getElementById('results').innerHTML += "Shellside velocity: " + shellVelocity.truncated() + " m/s<br>"
		
		var shellHeatTransferFactor = eval(document.getElementById("shellHeatTransFac").value)
		shellHeatTransferFactor = shellHeatTransferFactor.cutZero()
		var shellReynoldsNumber = shellStreamMeanDensity*shellVelocity*hydraulicDiameter/shellStreamMeanViscosity
		shellReynoldsNumber = shellReynoldsNumber.cutZero()
		var shellFlowType
		if (shellReynoldsNumber>1e4){
			shellFlowType = "turbulent"
		} else if (shellReynoldsNumber<2e3){
			shellFlowType = "laminar"
		} else {
			shellFlowType = "transition"
		}
		var shellPrandtlNumber = shellStreamMeanSHC*shellStreamMeanViscosity/shellStreamMeanTC
		shellPrandtlNumber = shellPrandtlNumber.cutZero()
		var shellNusseltNumber = shellHeatTransferFactor * shellReynoldsNumber * Math.pow(shellPrandtlNumber,.33)
		shellNusseltNumber = shellNusseltNumber.cutZero()
		var shellHeatTransCoeff = shellNusseltNumber/hydraulicDiameter*shellStreamMeanTC
		shellHeatTransCoeff = shellHeatTransCoeff.cutZero()
		document.getElementById('results').innerHTML += "<br>Reynolds number, Re: " + shellReynoldsNumber.truncated() + " (hence, " + shellFlowType + " region)<br>"
		document.getElementById('results').innerHTML += "Prandtl number, Pr: " + shellPrandtlNumber.truncated() + "<br>"
		
		document.getElementById('results').innerHTML += "<br>[Check and insert j<sub>H</sub> for shellside from Figure 12.29]<br><br>"
		
		document.getElementById('results').innerHTML += "Nusselt number, Nu: " + shellNusseltNumber.truncated() + "<br>"
		document.getElementById('results').innerHTML += "Heat-transfer coefficient, h<sub>s</sub>: " + shellHeatTransCoeff.truncated() + " W/m<sup>2</sup> °C<br>"
		
		var tubeWallTC = eval(document.getElementById("tubeWallTC").value)
		var reciprUtermTube = (1/tubeInsideCoefficient+tubeFoulFactor)*outerDiameter/innerDiameter
		var reciprUtermShell = 1/shellHeatTransCoeff+shellFoulFactor
		var reciprUtermHEx = outerDiameter*Math.log(outerDiameter/innerDiameter)/(2*tubeWallTC)
		reciprUtermTube = reciprUtermTube.cutZero()
		reciprUtermShell = reciprUtermShell.cutZero()
		reciprUtermHEx = reciprUtermHEx.cutZero()
		var reciprU = reciprUtermTube + reciprUtermShell + reciprUtermHEx
		reciprU = reciprU.cutZero()
		var overallCoefficient = 1/reciprU
		overallCoefficient = overallCoefficient.cutZero()
		document.getElementById('results').innerHTML += "<br>Reciprocal of U, 1/U: " + reciprU.truncated() + " (W/m<sup>2</sup> °C)<sup>-1</sup><br>"
		document.getElementById('results').innerHTML += "Overall heat-transfer coefficient, U: " + overallCoefficient.truncated() + " W/m<sup>2</sup> °C<br>"
		
		document.getElementById('results').innerHTML += "<br>[Check and insert j<sub>F</sub> for shellside from Figure 12.30]<br>"
		
		var tubeFrictionFactor = eval(document.getElementById("tubeFricFac").value)
		var tubePressDrop = nTubePass * (8*tubeFrictionFactor*tubeLength/innerDiameter + 2.5) * tubeStreamMeanDensity * tubeVelocity * tubeVelocity / 2
		tubePressDrop = tubePressDrop.cutZero()
		var recommendedTubeNumber
		if ((tubePressDrop-tubeAllowPress)>0){
			recommendedTubeNumber = Math.ceil(nTube/Math.sqrt((tubePressDrop-tubeAllowPress)/tubePressDrop))
			for (i=0;i<nTubePass;i++){
				var nTubePerPass = recommendedTubeNumber/nTubePass
				if (nTubePerPass%1==0){
					break;
				} else {
					recommendedTubeNumber++
				}
			}
		} else {
			recommendedTubeNumber = "not available; calculated pressure drop is lower than allowable pressure drop."
		}
		document.getElementById('results').innerHTML += "<br><b>Pressure Drop</b><br>"
		document.getElementById('results').innerHTML += "<br>Tubeside pressure drop, ΔP<sub>t</sub>: " + tubePressDrop.truncated() + " N/m<sup>2</sup><br>"
		document.getElementById('results').innerHTML += "Possible number of tubes needed: " + recommendedTubeNumber +"<br>"
		
		document.getElementById('results').innerHTML += "<br>[Does the tubeside pressure drop exceed specifications? If so, increase number of tubes]<br>"
		
		var shellFrictionFactor = eval(document.getElementById("shellFricFac").value)
		var shellPressDrop = (tubeLength/baffleSpacing) * (8*shellFrictionFactor*shellsideDiameter/hydraulicDiameter) * shellStreamMeanDensity * shellVelocity * shellVelocity / 2
		shellPressDrop = shellPressDrop.cutZero()
		document.getElementById('results').innerHTML += "<br>Shellside pressure drop, ΔP<sub>s</sub>: " + shellPressDrop.truncated() + " N/m<sup>2</sup><br>"
		
		document.getElementById('results').innerHTML += "<br>[Does the shellside pressure drop exceed specifications? If so, increase baffle spacing]<br>"
		
		var reqArea = nTube*areaPerTube
		reqArea.cutZero()
		var reqUo = Math.abs(duty/(reqArea*dTm))
		reqUo.cutZero()
		document.getElementById('results').innerHTML += "<br>Required Area, A<sub>o</sub>: " + reqArea.truncated() + " m<sup>2</sup><br>"
		document.getElementById('results').innerHTML += "Required overall coefficient, U<sub>o</sub>: " + reqUo.truncated() + "W/m<sup>2</sup> °C<br>"
		
		document.getElementById('results').innerHTML += "<br>[Are the above values good enough?]<br>"
		
		document.getElementById('results').innerHTML += "<br><b><u>Summary</u></b><br>"
		document.getElementById('results').innerHTML += "Heat transfer area: " + reqArea.truncated() + " m<sup>2</sup><br>"
		document.getElementById('results').innerHTML += "Tubeside coefficient: " + tubeInsideCoefficient.truncated() + " W/m<sup>2</sup> °C<br>"
		document.getElementById('results').innerHTML += "Shellside coefficient: " + "" + " W/m<sup>2</sup> °C<br>"
		document.getElementById('results').innerHTML += "Overall coefficient, estimated: " + overallCoefficient.truncated() + " W/m<sup>2</sup> °C<br>"
		document.getElementById('results').innerHTML += "Overall coefficient, required: " + reqUo.truncated() + "W/m<sup>2</sup> °C<br>"
		document.getElementById('results').innerHTML += "Tubeside pressure drop: " + tubePressDrop.truncated() + " N/m<sup>2</sup><br>"
		document.getElementById('results').innerHTML += "Shellside pressure drop: " + shellPressDrop.truncated() + " N/m<sup>2</sup><br>"
		
		var pressFactor = eval(document.getElementById("pressFac").value)
		var typeFactor = eval(document.getElementById("typeFac").value)
		var exchangerCost = eval(document.getElementById("exchCost").value)
		var exchangeRate = eval(document.getElementById("exchRate").value)
		var ratioIndex = eval(document.getElementById("indexRatio").value)
		var purchasedCost = Math.round(exchangerCost * typeFactor * pressFactor * 100)/100
		purchasedCost = purchasedCost.cutZero()
		var currentPurchasedCost = Math.round(purchasedCost * ratioIndex * 100)/100
		currentPurchasedCost = currentPurchasedCost.cutZero()
		var currentPurchasedCostMYR = Math.round(currentPurchasedCost * exchangeRate * 100)/100
		currentPurchasedCostMYR = currentPurchasedCostMYR.cutZero()
		document.getElementById('results').innerHTML += "<br>Purchased cost in 2016: $" + currentPurchasedCost + " (RM" + currentPurchasedCostMYR + ")<br>"
		
	}
	</script>
	
	<p class="hotFluid"><br><b>Stream 1 Properties and Conditions</b> [Known mass flow]<br>
	Mass Flow: <input type="text" class="inputText" id="stream1MassFlow" value="36500/3600"> kg/s<br>
	Inlet Temperature, T<sub>1</sub>: <input type="text" class="inputText" id="stream1InletTemp" value="59.9"> °C<br>
	Outlet Temperature, T<sub>2</sub>: <input type="text" class="inputText" id="stream1OutletTemp" value="40"> °C<br>
	
	Mean Spec Heat Capacity, C: <input type="text" class="inputText" id="stream1MeanSHC" value="2616"> J/kgK<br>
	
	Mean Thermal Conductivity, K: <input type="text" class="inputText" id="stream1MeanThermCond" value=".095793"> W/m °C<br>
	
	Mean Density, Rho: <input type="text" class="inputText" id="stream1MeanDensity" value="541.34"> kg/m<sup>3</sup><br>
	
	Mean Viscosity, Mu: <input type="text" class="inputText" id="stream1MeanViscosity" value="129.88e-3"> mNs/m<sup>2</sup> [cP]<br>
	
	Fouling factor: <input type="text" class="inputText" id="stream1FoulFact" value="0.0002"> (W/m<sup>2</sup> °C)<sup>-1</sup><br>
	
	Allowable pressure drop: <input type="text" class="inputText" id="stream1AllowPress" value="1e5"> N/m<sup>2</sup><br></p>
	
	<p class="coldFluid"><br><b>Stream 2 Properties and Conditions</b> [Unknown mass flow]<br>
	Inlet Temperature, t<sub>1</sub>: <input type="text" class="inputText" id="stream2InletTemp" value="32"> °C<br>
	Outlet Temperature, t<sub>2</sub>: <input type="text" class="inputText" id="stream2OutletTemp" value="40"> °C<br>
	
	Mean Spec Heat Capacity, c: <input type="text" class="inputText" id="stream2MeanSHC" value="4185"> J/kgK<br>
	
	Mean Thermal Conductivity, k<sub>1</sub>: <input type="text" class="inputText" id="stream2MeanThermCond" value=".61881"> W/m °C<br>
	
	Mean Density, rho<sub>1</sub>: <input type="text" class="inputText" id="stream2MeanDensity" value="992.13"> kg/m<sup>3</sup><br>
	
	Mean Viscosity, mu<sub>1</sub>: <input type="text" class="inputText" id="stream2MeanViscosity" value="783.21e-3"> mNs/m<sup>2</sup> [cP]<br>
	
	Fouling factor: <input type="text" class="inputText" id="stream2FoulFact" value="0.0003"> (W/m<sup>2</sup> °C)<sup>-1</sup><br>
	
	Allowable pressure drop: <input type="text" class="inputText" id="stream2AllowPress" value="1e5"> N/m<sup>2</sup><br></p>
	
	<p class="hEx"><br><b>Heat Exchanger</b><br>
	Estimated Overall Coefficient, U: <input type="text" class="inputText" id="estOverCoeff" value="500"> W/m<sup>2</sup> °C<br>
	Mode: <select id = "currentMode">
		<option value="counterCurrent">Counter-current</option>
		<option value="coCurrent">Co-current</option>
	</select><br>
	Correction Factor (get from chart using R and S, must be more than 0.75), F<sub>t</sub>: <input type="text" class="inputText" id="Ft" value="0.81"><br>
	Number of shell passes, m: <input type="text" class="inputText" id="nShellPass" value="1"><br>
	Number of tube passes, n : <select id = "nTubePass">
		<option value="1">1</option>
		<option value="2" selected>2</option>
		<option value="4">4</option>
		<option value="6">6</option>
		<option value="8">8</option>
	</select><br>
	Exchanger cost: US$ <input type="text" class="inputText" id="exchCost" value="35e3"><br>
	Pressure factor: <select id = "pressFac">
		<option value="1" selected>1-10</option>
		<option value="1.1">10-20</option>
		<option value="1.25">20-30</option>
		<option value="1.3">30-50</option>
		<option value="1.5">50-70</option>
	</select> bar<br>
	Type factor: <select id = "typeFac">
		<option value="1" selected>Floating head</option>
		<option value=".8">Fixed tube sheet</option>
		<option value=".85">U tube</option>
		<option value="1.3">Kettle</option>
	</select><br></p>
	
	<p class="hexTube"><br><u>Tubeside parameters</u><br>
	Fluid flowing through the tubes: <select id="flowCon">
		<option value="S2T1">Stream 1</option>
		<option value="S1T2" selected>Stream 2</option>
	</select><br>
	Number of tubes, N<sub>t</sub>: <input type="text" class="inputText" id="numberTubes" value="-1"> (Will be automatically generated if -1)<br>
	Outer diameter, d<sub>o</sub>: <input type="text" class="inputText" id="outerDiameter" value="16"> mm<br>
	Inner diameter, d<sub>i</sub>: <input type="text" class="inputText" id="innerDiameter" value="11.8"> mm<br>
	Tube length, L: <input type="text" class="inputText" id="tubeLength" value="2.44"> m<br>
	Pitch type: <select id = "currentPitch">
		<option value="triangular">Triangular</option>
		<option value="square">Square</option>
	</select><br>
	Heat Transfer Factor, j<sub>h</sub>: <input type="text" class="inputText" id="tubeHeatTransFac" value="4e-3"><br>
	Friction Factor, j<sub>F</sub>: <input type="text" class="inputText" id="tubeFricFac" value="5.6e-3"><br>
	Tube wall material thermal conductivity, k<sub>w</sub>: <input type="text" class="inputText" id="tubeWallTC" value="55"> W/m °C<br></p>
	
	<p class="hexShell"><br><u>Shellside parameters</u><br>
	Shell clearance: <input type="text" class="inputText" id="shellClear" value="92"> mm<br>
	Baffle spacing: <input type="text" class="inputText" id="baffleSpace" value="150"> mm<br>
	Heat Transfer Factor, j<sub>h</sub>: <input type="text" class="inputText" id="shellHeatTransFac" value="3e-3"><br>
	Friction Factor, j<sub>F</sub>: <input type="text" class="inputText" id="shellFricFac" value="4.0e-2"><br></p>
	
	<p><b>Other</b><br>
	Exchange rate: 1 USD = <input type="text" class="inputText" id="exchRate" value="4.06"> MYR<br>
	Ratio of current year to reference year index: <input type="text" class="inputText" id="indexRatio" value="573/444"><br>
	Significant figures: <input type="text" class="inputText" id="signif" value="10"> (inaccurate for significant figures higher than 14)<br></p>
	
	<br><input type=button value="Calculate" onClick="calculate_this()"><br>
	<br><span id="results">(click "Calculate")</span>
	
	</body>
</html>
